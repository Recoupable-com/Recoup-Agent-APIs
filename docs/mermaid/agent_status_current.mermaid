graph TD
    Start[Start] --> CreateAgent[Create Agent]
    CreateAgent --> ProcessPlatform[Process Platform]
    
    subgraph Platform Processing
        ProcessPlatform --> CreateSocial[Create Social Record]
        CreateSocial --> NoStatus[Gap: No Status] --> Profile[Set Status: PROFILE]
        Profile --> NoScraping[Gap: No Scraping Status] --> SetupArtist[Set Status: SETTING_UP_ARTIST]
        SetupArtist --> PostURLs[Set Status: POSTURLS]
        PostURLs --> NoStorage[Gap: No Storage Status] --> PostComments[Set Status: POST_COMMENTS]
        PostComments --> NoCommentStorage[Gap: No Comment Storage Status] --> Finished[Set Status: FINISHED]
    end

    subgraph Error States
        PostURLs --> |Posts Failed|MissingPosts[Status: MISSING_POSTS]
        ProcessPlatform --> |Rate Limited|RateLimit[Status: RATE_LIMIT_EXCEEDED]
        Profile --> |Profile Not Found|UnknownProfile[Status: UNKNOWN_PROFILE]
    end

    subgraph Global Status
        Finished --> |All Complete|Segments[Set All Status: SEGMENTS]
        Segments --> |After Generation|GlobalFinished[Set All Status: FINISHED]
    end

    classDef gap fill:#ff9999,stroke:#333,stroke-width:2px;
    classDef status fill:#99ff99,stroke:#333,stroke-width:2px;
    classDef error fill:#ffcc99,stroke:#333,stroke-width:2px;
    classDef process fill:#ffffff,stroke:#333,stroke-width:2px;

    class Profile,SetupArtist,PostURLs,PostComments,Finished,Segments,GlobalFinished status;
    class MissingPosts,RateLimit,UnknownProfile error;
    class CreateAgent,CreateSocial,ProcessPlatform process;
    class NoStatus,NoScraping,NoStorage,NoCommentStorage gap; 